{% extends "base.html" %}

{% block title %}Моє Відвідування{% endblock %}

{% block header_title %}Відвідування{% endblock %}

{% block content %}
<div class="glass-panel rounded-3xl p-8 mb-8" role="region" aria-label="Таблиця відвідування">
    <form method="GET" action="{% url 'student_attendance' %}" class="flex flex-col md:flex-row flex-wrap gap-4 mb-8">
        <div class="flex flex-col gap-2">
            <label for="date-from-att" class="text-sm font-medium text-bodyText">Дата від:</label>
            <input type="date" id="date-from-att" name="date_from"
                class="px-4 py-2 border border-tableBorder rounded-xl text-dark bg-white focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-200"
                value="{{ request.GET.date_from }}">
        </div>
        <div class="flex flex-col gap-2">
            <label for="date-to-att" class="text-sm font-medium text-bodyText">До:</label>
            <input type="date" id="date-to-att" name="date_to"
                class="px-4 py-2 border border-tableBorder rounded-xl text-dark bg-white focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all duration-200"
                value="{{ request.GET.date_to }}">
        </div>
        <div class="flex items-end">
            <button type="submit" class="btn bg-primary text-white shadow-button hover:bg-blue-600 hover:shadow-button-hover py-2 px-6">
                Фільтрувати
            </button>
            <a href="{% url 'student_attendance' %}" class="ml-2 btn bg-gray-200 text-dark hover:bg-gray-300 py-2 px-4 rounded-xl">
                Скинути
            </a>
        </div>
    </form>

    <div class="overflow-x-auto rounded-xl border border-tableBorder bg-white shadow-sm">
        <table class="w-full border-collapse">
            <thead>
                <tr>
                    <th class="bg-primary text-white p-4 text-left text-xs font-bold uppercase tracking-wider">Дата</th>
                    <th class="bg-primary text-white p-4 text-left text-xs font-bold uppercase tracking-wider">Предмет</th>
                    <th class="bg-primary text-white p-4 text-left text-xs font-bold uppercase tracking-wider">Викладач</th>
                    <th class="bg-primary text-white p-4 text-left text-xs font-bold uppercase tracking-wider">Причина</th>
                    <th class="bg-primary text-white p-4 text-center text-xs font-bold uppercase tracking-wider">Пара</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-tableBorder text-dark">
                {% for entry in absences %}
                <tr class="{% cycle 'bg-tableBgLight' 'bg-tableBgDark' %} hover:bg-primary/10 transition-colors duration-200">
                    <td class="p-4 font-bold text-error">{{ entry.lesson.date|date:"d.m.Y" }}</td>
                    <td class="p-4 font-medium">{{ entry.lesson.assignment.subject.name }}</td>
                    <td class="p-4 text-sm">{{ entry.lesson.assignment.teacher.full_name }}</td>
                    <td class="p-4">
                        <span class="px-2 py-1 rounded-md text-xs font-bold uppercase
                            {% if entry.absence.is_respectful %}bg-green-100 text-green-700{% else %}bg-red-100 text-red-700{% endif %}">
                            {{ entry.absence.description }} ({{ entry.absence.code }})
                        </span>
                    </td>
                    <td class="p-4 text-center">{{ entry.lesson.lesson_number }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="p-8 text-center text-neutral text-lg">Пропусків не зафіксовано.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}